Документы
==================================================================================================

Данный раздел описывает документы и процессы документов

Требования
----------------------

Описание документа
______________________________

..   
	Сформирована через БП sphinx_sql_to_table
	select title "операция",priority "приоритет" from k2opertype where entity_id=1280
    and priority<>0
    order by 1

.. list-table:: Виды операций для документа "Требования"
   :header-rows: 1

   * - операция
     - приоритет
   * - ВнПТ
     - 5000
   * - ИР1
     - 1000
   * - ИР2
     - 2000
   * - ИР3
     - 3000
   * - ИР3 НК
     - 3000
   * - ИР4
     - 4000
   * - ОПВ/ОППВ
     - 2000
   * - Платежный ордер/ Комиссия Банка
     - 5000
   * - Платежный ордер/ Комиссия Банка(Без контроля ПМ )
     - 5000
   * - ПТ
     - 5000
	 
	 
..   
	Сформирована через БП sphinx_sql_to_table
	select s.title as "наименование_статуса", s.can_edit "возможность_коррекции",s.enable_refuse "возможность_отзыва",  krr.code "код_возврата_mt"from k2req_stat s
    join k2return_reason krr on krr.id = s.return_mt_reason_id

.. list-table:: Статусы требований
   :header-rows: 1

   * - наименование_статуса
     - возможность_коррекции
     - возможность_отзыва
     - код_возврата_mt
   * - Введен
     - 1
     - 0
     - 05
   * - Исполнено
     - 0
     - 0
     - 07
   * - Принято к исполнению
     - 0
     - 0
     - 08
   * - Принята картотека
     - 0
     - 1
     - 08
   * - Возвращено банком
     - 0
     - 0
     - 06
   * - Отозвано
     - 0
     - 0
     - 06
   * - не принято/неправильные реквизиты
     - 0
     - 0
     - 05
   * - На доработке
     - 1
     - 0
     - 05
   * - Приостановлена пользователем
     - 0
     - 1
     - 08
   * - На ручной обработке
     - 1
     - 0
     - 05
   * - Импортирован
     - 0
     - 0
     - 05
	 
Скриншот экранной формы Требования

.. image:: img/pt.png
  :width: 100%
  :alt: Требование

При создании документу присваивается приоритет исходя из вида операций. Приоритет может быть от 0 до 5000

Каждый документ содержит **Код Группы** для учета долга по требованию

**Референс** является обязательным и уникальным полем

**Абонент** является обязательным полем для требований по электронным каналам

**Система** является обязательным полем. Система определяется по системе (АБС) основного счету, по которому выставилось требование

**Дата приема** заполняется вручную, а в электронных каналах автоматически

**Дата загрузки** заполняется автоматически для электронных каналах

**Номер документа** заполняется из сообщения MT или XML(АИС ОИП)

**Дата документа** заполняется из сообщения MT или XML(АИС ОИП)

**Дата документа** заполняется из сообщения MT или XML(АИС ОИП)

**ИИН клиента** одтягивается из  MT или XML(АИС ОИП). При ручном вводе заполняется вручную.

**Наименование счета** подтягивается из  MT или XML(АИС ОИП). При ручном вводе подтягивается автоматически из справочника Счета k2acc.title

Поле **КОД** подтягивается автоматически из карточки клиента по полю k2acc.residfl + k2acc.sect_id

**Номер договора ДБЗ** и **Дата ДБЗ** подтягивается из MT файла по ПТ БВУ.

**Назначение платежа** заполняется из  MT или XML(АИС ОИП) по электронным каналам либо вводится вручную

**Сумма требования** заполняется из  MT или XML(АИС ОИП) по электронным каналам либо вводится вручную

**Валюта** заполняется из  MT или XML(АИС ОИП) по электронным каналам либо вводится вручную

**КНП** заполняется из  MT или XML(АИС ОИП) по электронным каналам либо вводится вручную

**Руководитель** и **Бухгалтер заполняется** из  MT или XML(АИС ОИП) по электронным каналам либо подтягивается автоматически из справочника Банки (k2bank).

**Счета по требованию** заполняются автоматически, если средств на основном счете требования недостаточно для исполнения требования

**Платежи по требованию** формируются если средств на счете достаточно

Если по требованию сработали проверки, то добавляется **чек лист** с описанием ошибки

Бизнес-процессы по требованию
____________________________________


**k2reqs_post - Регистрация требования**

Скриншот схемы BPMN 2.0 k2reqs_post - Регистрация требования

.. image:: svg/k2reqs_post.svg
  :width: 100%
  :alt: Требование

**k2req_refuse - Отозвать требование**

Скриншот схемы BPMN 2.0 k2req_refuse - Отозвать требование

.. image:: svg/k2req_refuse.svg
  :width: 100%
  :alt: Требование

**k2req_return - Возврат требования**

Скриншот схемы BPMN 2.0 k2req_return - Возврат требования

.. image:: svg/k2req_return.svg
  :width: 100%
  :alt: Требование

**k2req_suspend - Приостановить требование**


Скриншот схемы BPMN 2.0 k2req_suspend - Приостановить требование

.. image:: svg/k2req_suspend.svg
  :width: 100%
  :alt: Приостановить требование


**k2req_set_priority - Установить приоритет требования**

**k2req_check - Проверка требования**

**k2req_refuse_1year - Отозвать по истечению года**

Исходящие требования
----------------------

Отзывы исходящих требований
-------------------------------

Входящие запросы
---------------------------

Запрос о наличии счетов
--------------------------

Счета в другом банке
--------------------------

